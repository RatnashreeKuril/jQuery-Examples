<!DOCTYPE HTML>
<html>
<head>
<meta charset='utf-8'>
<title>JQuery Examples</title>
<link rel='stylesheet' href='jquery-ui-1.13.2/jquery-ui.css'>
<link rel='stylesheet' href='fontawesome-6.5.1/css/all.css'>
<script src='jquery/jquery-3.7.1.min.js'></script>
<script src='jquery-ui-1.13.2/jquery-ui.js'></script>
<style>
table
{
border : 1px solid black;
border-collapse : collapse;
}
table th
{
border : 1px solid black;
padding : 2px;
}
table td
{
padding : 2px;
border : 1px solid black;
cursor : pointer;
}
.paginationControls
{
padding : 5px;

}
.paginationControls i
{
padding : 10px;
border : 1px solid black;
cursor : pointer;
}


</style>

<script>

const getCustomers=()=>{
var promise=new Promise((resolve,reject)=>{

fetch("/getCustomers").then((response)=>{
if(!response.ok) throw Error("Cannot fetch data");
return response.json();
}).then((customers)=>{
resolve(customers);
}).catch((error)=>{
reject(error.message);
});

});
return promise;
}


var dataModel={
customers : [],
pageNumber : 0,
pageSize : 0
};

const updateView=()=>{

var previousButton=$("#previousButton");
var nextButton=$("#nextButton");

previousButton.hide();
nextButton.hide();
//alert(dataModel.pageNumber);
var startIndex=(dataModel.pageNumber-1)*dataModel.pageSize;
var endIndex=startIndex+dataModel.pageSize-1;
if(endIndex>dataModel.customers.length-1)
{
endIndex=dataModel.customers.length-1;
}
//alert(startIndex+", "+endIndex);
var tbody=$("#customerView").find("tbody");
tbody.html("");
var i=startIndex;
while(i<=endIndex)
{
tbody.append($(`<tr><td>${i+1}</td><td>${dataModel.customers[i].id}</td><td>${dataModel.customers[i].firstName}</td><td>${dataModel.customers[i].lastName}</td></tr>`));
i++;
}

if(startIndex>0)
{
previousButton.show();
}
if(endIndex<dataModel.customers.length-1)
{
nextButton.show();
}

} // updateView ends

const goToNextPage=()=>{
dataModel.pageNumber++;
updateView();
}

const goToPreviousPage=()=>{
dataModel.pageNumber--;
updateView();
}

$(()=>{

getCustomers().then((customers)=>{
dataModel.customers=customers;
dataModel.pageNumber=1;
dataModel.pageSize=10;
updateView();
},(error)=>{
alert(error);
});
});

</script>
</head>
<body>

<h1>Example 87</h1>
<h3>Customers</h3>
<table id='customerView'>
<thead>
<tr>
<th>S.No.</th>
<th>Id</th>
<th>First name</th>
<th>Last name</th>
</tr>
</thead>
<tbody>

</tbody>
</table>

<div class='paginationControls'>
<i id='previousButton' class='fas fa-arrow-circle-left' onClick='goToPreviousPage()'></i>
<i id='nextButton' class='fas fa-arrow-circle-right' onClick='goToNextPage()'></i>
</div>

<br><a href='/'>Home</a>
</body>
</html>